
@{
    ViewBag.Title = "JqueryForm";
}

<h2>JqueryForm</h2>
<div class="form-horizontal">
    <div>
        <div class="form-group">
            <label class="control-label col-md-2">Code</label>
            <input type="text" placeholder="Enter Your Code" class="col-md-4" id="code"/>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">DOB</label>
            <input type="date" class="col-md-4" id="dob"/>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">Name</label>
            <input type="text" placeholder="Enter Your Name" class="col-md-4" id="name"/>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">Gender</label>
            
                <input type="radio" name="Gender" value="1" /> Male
                <input type="radio" name="Gender" value="2" /> Female
                <input type="radio" name="Gender" value="3" /> Transgender
                <input type="radio" name="Gender" value="4" /> Prefer not to disclose
            
        </div>

        <div class="form-group" id="languages">
            <label class="control-label col-md-2">Languages known</label>

        </div>

        <div class="form-group">
            <label class="control-label col-md-2">Salary</label>
            <input type="number" id="salary"/>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">State</label>
            <select  id="state">
                <option value="State">---SELECT STATE---</option>
            </select>
        </div>

        <div class="form-group" >
            <label class="control-label col-md-2">City</label>
            <select id="city">
                <option value="Select">---SELECT CITY---</option>
            </select>
        </div>

        <div class="control-label col-md-2">
            <input type="submit" value="Submit"  id="btnSubmit"/>
        </div>
    </div>
</div>

<script>
    loadDefault();
    loadCityOnStateSelection();
    submitValues();



    function loadDefault() {
        $.ajax({
            url: 'GetDefaultValues',
            success: function (data) {
                
                $.each(data.LanguagesKnown, function (i, item) {
                    $("#languages").append('<input type="checkbox" name="chkLanguages" value=' + item.languageId + ' />' + item.languageName+'');
                })

                $("#state").html('');
                $("#state").append('<option value="State">---SELECT STATE---</option>');
                $.each(data.States, function (i, item) {
                    $("#state").append('<option value='+item.stateid +'>' +item.stateName + '</option>');
                })

            },
            error: function (data) {
                console.log("Error Fetching Data")
            }

        });
    }

    function loadCityOnStateSelection() {
        

        $("#state").on("change", function () {
            var state = $("#state").val();
            //console.log('state', state);

            var obj = { state: state };
            //console.log('obj', obj);

            $.ajax({
                url: 'GetCityByState',
                type: 'POST',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify(obj),
                success: function (data) {
                    //console.log('DAta returned', data);

                    $("#city").html('');
                    $("#city").append('<option value="City">---SELECT CITY---</option>');
                    $.each(data, function (i, item) {
                    $("#city").append('<option value=' + item.cityId + '>' + item.cityName + '</option>');
                    })
                },
                error: function (data) {
                    console.log("Error fetching data from GetCityByState");
                }
            })
        })

    }

    function submitValues() {
        $("#btnSubmit").click(function () {
            
            var code = $("#code").val();
            console.log('code', code);

            var dob = $("#dob").val();
            console.log('dob', dob);

            var name = $("#name").val();
            console.log('name', name);
            
            var gender = $("input[name=Gender]:checked").val();
            console.log('gender', gender);
            //
            var arrLanguages = [];
            $.each($("input[name=chkLanguages]:checked"), function () {
                arrLanguages.push($(this).val());
            });

            $.each(arrLanguages, function (i, item) {
                console.log('Languages Known', item );
            });
            
            var dob = $("#dob").val();
            console.log('dob', dob);
            
            var salary = $("#salary").val();
            console.log('salary', salary);

            var state = $("#state").val();
            console.log('state', state);

            var city = $("#city").val();
            console.log('city', city);

        });
    }

</script>

